## Gerenciamento de Artefatos no Google Cloud

**1\. Serviços Google e Clusters de Contêineres**

O Google Cloud oferece vários serviços para o gerenciamento de contêineres, sendo o Google Kubernetes Engine (GKE) um dos mais utilizados para orquestração de contêineres. O Google Cloud Artifact Registry permite armazenar, gerenciar e acessar artefatos como imagens de contêiner, pacotes Java, e outros pacotes de software.

**· Google Kubernetes Engine (GKE)**: GKE é uma plataforma gerenciada de Kubernetes que facilita a execução de clusters de contêineres de forma escalável e confiável. Ele permite a implantação automática, escalonamento e gerenciamento de clusters no Google Cloud.

**· Artifact Registry:** Este serviço substitui o Google Container Registry (GCR) e é usado para armazenar não apenas imagens de contêineres, mas também outros tipos de pacotes, como pacotes Maven, npm, entre outros.

Um projeto que usa serviços de contêineres pode armazenar imagens de contêiner no Artifact Registry e gerenciar sua execução em um cluster Kubernetes no GKE, permitindo o desenvolvimento, teste e escalonamento contínuo de aplicações.

2\. Trabalhando com Imagens de Contêiner

Imagens de contêiner são fundamentais para o desenvolvimento e implantação de aplicativos em ambientes de nuvem. Elas contêm todo o ambiente de execução, bibliotecas e código necessário para rodar um aplicativo.

**Passos para Trabalhar com Imagens de Contêiner no Google Cloud:**

**1\. Construir uma Imagem Docker:**

\- No diretório do projeto, crie uma imagem Docker a partir de um Dockerfile:

| docker build -t [gcr.io/\[PROJECT\_ID\]/my-app:v1](http://gcr.io/%5BPROJECT_ID%5D/my-app:v1) . |
| --- |

**2\. Autenticação no Artifact Registry:**

Autentique o Docker para enviar imagens ao Google Cloud:

| gcloud auth configure-docker |
| --- |

**3\. Enviar a Imagem para o Artifact Registry:**

Após a autenticação, envie a imagem para o repositório do Google Cloud:

| docker push [gcr.io/\[PROJECT\_ID\]/my-app:v1](http://gcr.io/%5BPROJECT_ID%5D/my-app:v1) |
| --- |

**4\. Usar a Imagem em um Cluster GKE:**

Implante a imagem em um cluster GKE configurando um manifesto YAML para o deployment:  

| apiVersion: apps/v1​  kind: Deployment​  metadata:​    name: my-app-deployment​  spec:​    replicas: 2​    selector:​      matchLabels:​        app: my-app​    template:​      metadata:​        labels:​          app: my-app​      spec:​        containers:​        - name: my-app​          image: [gcr.io/\[PROJECT\_ID\]/my-app:v1](http://gcr.io/%5BPROJECT_ID%5D/my-app:v1)​          ports:​          - containerPort: 8080​ |
| --- |

Após construir uma imagem Docker para um aplicativo web, você pode enviá-la para o Artifact Registry e depois usá-la para implantar e rodar o aplicativo em um cluster GKE, com alta disponibilidade e escalabilidade.

3\. Integração com Cloud Code

O Cloud Code é uma extensão do Google Cloud para ambientes de desenvolvimento integrados (IDE) como Visual Studio Code e IntelliJ, que facilita o desenvolvimento, a construção e o teste de aplicativos baseados em contêineres e Kubernetes diretamente da sua IDE.

**Recursos da Integração com Cloud Code:**

**1\. Configuração Automática de Kubernetes e GKE:**

\- O Cloud Code fornece templates e comandos para criar, configurar e gerenciar clusters Kubernetes e implantações GKE diretamente do ambiente de desenvolvimento.

**2\. Ciclo de Desenvolvimento Simplificado:**

\- O Cloud Code permite construir, executar e depurar imagens de contêiner sem sair da sua IDE, simplificando o ciclo de desenvolvimento e integração contínua.

**3\. Monitoramento e Logs:**

\- O Cloud Code facilita a visualização dos logs e status do cluster Kubernetes ou do GKE em tempo real, permitindo uma depuração mais eficiente.

Um desenvolvedor pode usar o Cloud Code no Visual Studio Code para construir, testar e enviar imagens de contêiner diretamente para o Google Cloud, implantando-as em um cluster GKE e monitorando os logs do aplicativo em tempo real.

4\. Criação de um Repositório de Pacotes Java

O Artifact Registry também suporta pacotes de software além de imagens de contêiner, incluindo pacotes Java (Maven), permitindo que bibliotecas e dependências sejam armazenadas e gerenciadas no Google Cloud.

**Passos para Criar um Repositório de Pacotes Java:**

**1\. Criar o Repositório no Artifact Registry:**

\- No Google Cloud Console, vá para Artifact Registry e clique em “Criar Repositório”.

\- Selecione Maven como o formato do repositório, escolha a região e dê um nome ao repositório.

**2\. Configurar o Projeto Maven:**

\- Adicione o repositório Maven ao seu projeto, configurando o arquivo pom.xml para incluir o repositório Maven do Artifact Registry:**​**

| <repositories>    <repository>​      <id>artifact-registry</id>​      <url>https://\[LOCATION\]-maven.pkg.dev/\[PROJECT\_ID\]/my-repo</url>​    </repository>  </repositories> |
| --- |

**3\. Enviar Pacotes Java ao Repositório:**

\- Use o comando mvn deploy para enviar pacotes Maven para o repositório:  
mvn deploy

**4\. Gerenciar e Acessar os Pacotes:**

\- Depois que o pacote estiver no Artifact Registry, ele pode ser acessado e utilizado por outros projetos e pipelines de CI/CD no Google Cloud.

Uma equipe de desenvolvimento que utiliza bibliotecas internas de Java pode armazenar e compartilhar essas dependências através do Artifact Registry, garantindo que diferentes projetos tenham acesso às versões corretas de cada pacote.

**Práticas de Segurança no Gerenciamento de Artefatos**

Ao trabalhar com artefatos como imagens de contêiner e pacotes de software no Google Cloud, a segurança é fundamental. Incluir este tópico como extra ajudará os alunos a entender as melhores práticas de segurança no gerenciamento de artefatos.

**1\. Controle de Acesso Baseado em Funções (RBAC):**

\- Use o Google Cloud IAM para garantir que somente os usuários autorizados possam acessar ou enviar artefatos. Por exemplo, um papel de “Viewer” pode ser atribuído a desenvolvedores que apenas precisam ler pacotes, enquanto um papel de “Admin” pode ser atribuído a quem gerencia o repositório.

\- Exemplo: Definir permissões granulares no Artifact Registry para garantir que um grupo de desenvolvedores tenha acesso a apenas determinados repositórios, enquanto administradores têm permissões completas.

**2\. Assinatura e Verificação de Imagens:**

\- Assegure que as imagens de contêiner sejam seguras ao usar Binary Authorization, um serviço que força políticas de assinatura e verificação de imagens antes que elas possam ser implantadas no Google Kubernetes Engine (GKE).

\- Exemplo: Configure políticas de assinatura de imagens para garantir que apenas imagens aprovadas e verificadas sejam usadas em produção.

**3\. Escaneamento de Vulnerabilidades:**

\- O Container Analysis do Google Cloud permite escanear imagens armazenadas no Artifact Registry em busca de vulnerabilidades de segurança. Incorporar essa prática ajuda a garantir que as imagens estejam seguras antes da implantação.

\- Exemplo: Configurar escaneamento automatizado para que qualquer vulnerabilidade crítica detectada em uma imagem de contêiner seja comunicada à equipe de segurança para correção.

**4\. Automatização de CI/CD com Segurança:**

\- Integre pipelines de CI/CD (Integração e Entrega Contínua) que incorporem verificações de segurança no processo de envio de artefatos. Isso pode incluir a automatização do deploy seguro e monitoramento contínuo de artefatos.

\- Exemplo: Usar o Cloud Build para automatizar a construção, teste e envio de artefatos para o Artifact Registry, garantindo que todas as verificações de segurança sejam executadas no pipeline.

**Extra: Monitoramento e Auditoria de Artefatos no Google Cloud**

Monitorar e auditar quem está acessando e modificando os artefatos é uma parte importante da governança em projetos na nuvem.

**1\. Cloud Audit Logs:**

\- O Google Cloud oferece Cloud Audit Logs, que registram todas as atividades de gerenciamento e acesso a recursos, como o Artifact Registry. Isso é importante para fins de auditoria e conformidade.

\- Exemplo: Configurar os logs de auditoria para monitorar quem está enviando, acessando ou removendo artefatos dos repositórios.

**2\. Alerta e Monitoramento Proativo:**

\- Configure alertas usando o Google Cloud Monitoring para notificar a equipe em caso de comportamentos suspeitos ou uso não autorizado de artefatos. Isso pode ajudar a prevenir acessos indevidos e garantir a segurança do pipeline de entrega.

\- Exemplo: Definir alertas para situações como número elevado de falhas no deploy de contêineres, tempo excessivo de build, ou acessos suspeitos ao Artifact Registry.

  

**Conteúdo Bônus  
**  
**Título:** Documentação do Artifact Registry  
**Plataforma:** Cloud.Google  
**Descrição:** “Um gerenciador de pacotes universal para todos os artefatos e dependências de compilação. Rápido, escalonável, confiável e seguro.”

  

**Referências Bibliográficas**  
  
BASSO, D. E. **Administração de Redes de Computadores**. Contentus, 2020.  
KUROSE, J. F.; ROSS, K. W. **Redes de Computadores e a Internet: Uma Abordagem Top-Down**. 8. ed. Pearson, 2021.  
MARINHO, A. L.; CRUZ, J. L. da. (Orgs.). **Desenvolvimento de Aplicações para Internet**. 2. ed. Pearson, 2020.  
PUGA, S.; RISSETTI, G. **Lógica de Programação e Estruturas de Dados, com Aplicações em Java**. 3. ed. Pearson, 2016.  
ROHLING, L. J. **Segurança de Redes de Computadores**. Contentus, 2020.  
SILVA, C. F. da. **Projeto Estruturado e Gerência de Redes**. Contentus, 2020.  
TANENBAUM, A. S.; FEAMSTER, N.; WETHERALL, D. J. **Redes de Computadores**. 6. ed. Pearson, 2021.  
TOCCI, R. J.; WIDMER, N. S.; MOSS, G. L. **Sistemas Digitais: Princípios e Aplicações**. 12. ed. Pearson, 2018.